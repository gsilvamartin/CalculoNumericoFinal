"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Norms_1 = require("../../../operations/Norms");
var RadialBasisFunction_1 = require("./RadialBasisFunction");
/**
 * Creates a gaussian {@link Kernel} for use in a {@link SupportVectorMachineClassifier}.
 * The gaussian kernel converts a data {@link Matrix} into a similarity `Matrix`
 * where the value of entry (i,j) expresses the similarity of rows i and j in
 * the original data set.
 *
 * @param sigmaSquared - The variance of the gaussian distribution used in the kernel
 *
 * @public
 */
function GaussianKernel(sigmaSquared) {
    return RadialBasisFunction_1.RadialBasisFunction(function (v1, v2) { return gaussianSimilarity(sigmaSquared, v1, v2); });
}
exports.GaussianKernel = GaussianKernel;
/**
 * {@see SimilarityMetric}
 */
function gaussianSimilarity(sigmaSquared, v1, v2) {
    var diff = Norms_1.euclideanNorm(v1.add(v2.scalarMultiply(-1)));
    return gaussian(diff, sigmaSquared);
}
function gaussian(x, variance) {
    var exponent = -(x * x) / (2 * variance);
    return Math.exp(exponent);
}
//# sourceMappingURL=GaussianKernel.js.map